{"version":3,"file":"piechart.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/piechart/index.js"],"sourcesContent":["import vegaEmbed from \"vega-embed\";\n\nexport default async function piechart(stanza, params) {\n  let spec = await fetch(params[\"src-url\"]).then((res) => res.json());\n\n  //stanza（描画範囲）のwidth・height（うまく効かない…広くなってしまう？）\n  // spec.width = params[\"width\"]\n  // spec.height = params[\"height\"]\n  // spec.autosize = params[\"autosize\"]\n  spec.padding = {\"left\": 5, \"top\": 5, \"right\": 150, \"bottom\": 5}\n\n// scales: カラースキームを指定\n  spec.scales[0].range = [\n    'var(--series-0-color)',\n    'var(--series-1-color)',\n    'var(--series-2-color)',\n    'var(--series-3-color)',\n    'var(--series-4-color)',\n    'var(--series-5-color)'\n  ]\n\n\n//円の描画について\n  //（デフォルトのコントローラを削除） \n  for (let signal of spec.signals)\n    { \n      delete(signal.bind); \n    } \n  \n  spec.signals[2].value = params[\"inner-padding-angle\"]\n  spec.signals[3].value = params[\"inner-radius\"]\n\n  spec.marks[0].encode = {\n    \"enter\": {\n      \"fill\": {\"scale\": \"color\", \"field\": \"id\"},\n      \"x\": {\"signal\": \"width / 2\"},\n      \"y\": {\"signal\": \"height / 2\"}\n    },\n    \"update\": {\n      \"startAngle\": {\"field\": \"startAngle\"},\n      \"endAngle\": {\"field\": \"endAngle\"},\n      \"padAngle\": {\"signal\": \"padAngle\"},\n      \"innerRadius\": {\"signal\": \"innerRadius\"},\n      \"outerRadius\": {\"signal\": \"width / 2\"},\n      \"cornerRadius\": {\"signal\": \"cornerRadius\"},\n      \"fill\": {\"scale\": \"color\", \"field\": \"id\"}\n    },\n    \"hover\": {\n      \"fill\": {\"value\": \"var(--emphasized-color)\"}\n    }\n  }\n\n  // // hover時にvalueを出したい\n  // spec.marks[1].encode = {\n  //   \"enter\": {\n  //     // \"align\": {\"value\": \"center\"},\n  //     // \"baseline\": {\"value\": \"bottom\"},\n  //     \"fill\": {\"value\": \"var(--emphasized-color)\"},\n  //     // \"font\":{\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--label-font\")},\n  //     // \"fontSize\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--fontsize-of-value\")},\n  //     // \"fontWeight\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--fontweight-of-value\")}\n  //   },\n  //   \"update\": {\n  //     \"x\": {\"signal\": \"tooltip.category\", \"band\": 0.5},\n  //     \"y\": {\"signal\": \"tooltip.amount\", \"offset\": -1},\n  //     \"text\": {\"signal\": \"tooltip.id\"},\n  //     \"fillOpacity\": [\n  //       {\"test\": \"datum === tooltip\", \"value\": 0},\n  //       {\"value\": 1}\n  //     ]\n  //   }\n  // }\n\n  //legendを出す\n  spec.legends =\n  [\n    {\n      \"fill\": \"color\",\n      \"orient\": \"none\",\n      \"legendX\": \"220\",\n      \"legendY\": \"5\",\n      \"title\": params[\"legend-title\"],\n      \"titleColor\": \"var(--legendtitle-color)\",\n      \"labelColor\": \"var(--legendlabel-color)\",\n      \"encode\": {\n        \"title\": {\n          \"update\": {\n            \"font\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--legend-font\")},\n            \"fontSize\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--legendtitle-size\")},\n            \"fontWeight\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--legendtitle-weight\")}\n          }\n        },\n        \"labels\": {\n          \"interactive\": true,\n          \"update\": {\n            \"font\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--legend-font\")},\n            \"fontSize\": {\"value\": getComputedStyle(stanza.root.host).getPropertyValue(\"--legendlabel-size\")}},\n            \"text\": {\"field\": \"value\"}\n          }\n        }\n      }\n  ]\n\n  const el = stanza.root.querySelector(\"main\");\n  const opts = {\n    renderer: \"svg\"\n  };\n  await vegaEmbed(el, spec, opts);\n}"],"names":["vegaEmbed"],"mappings":";;;;;AAEe,eAAe,QAAQ,CAAC,MAAM,EAAE,MAAM,EAAE;AACvD,EAAE,IAAI,IAAI,GAAG,MAAM,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;AACtE;AACA;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,OAAO,GAAG,CAAC,MAAM,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,QAAQ,EAAE,CAAC,EAAC;AACjE;AACA;AACA,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG;AACzB,IAAI,uBAAuB;AAC3B,IAAI,uBAAuB;AAC3B,IAAI,uBAAuB;AAC3B,IAAI,uBAAuB;AAC3B,IAAI,uBAAuB;AAC3B,IAAI,uBAAuB;AAC3B,IAAG;AACH;AACA;AACA;AACA;AACA,EAAE,KAAK,IAAI,MAAM,IAAI,IAAI,CAAC,OAAO;AACjC,IAAI;AACJ,MAAM,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;AAC1B,KAAK;AACL;AACA,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,qBAAqB,EAAC;AACvD,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,KAAK,GAAG,MAAM,CAAC,cAAc,EAAC;AAChD;AACA,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG;AACzB,IAAI,OAAO,EAAE;AACb,MAAM,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC;AAC/C,MAAM,GAAG,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC;AAClC,MAAM,GAAG,EAAE,CAAC,QAAQ,EAAE,YAAY,CAAC;AACnC,KAAK;AACL,IAAI,QAAQ,EAAE;AACd,MAAM,YAAY,EAAE,CAAC,OAAO,EAAE,YAAY,CAAC;AAC3C,MAAM,UAAU,EAAE,CAAC,OAAO,EAAE,UAAU,CAAC;AACvC,MAAM,UAAU,EAAE,CAAC,QAAQ,EAAE,UAAU,CAAC;AACxC,MAAM,aAAa,EAAE,CAAC,QAAQ,EAAE,aAAa,CAAC;AAC9C,MAAM,aAAa,EAAE,CAAC,QAAQ,EAAE,WAAW,CAAC;AAC5C,MAAM,cAAc,EAAE,CAAC,QAAQ,EAAE,cAAc,CAAC;AAChD,MAAM,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC;AAC/C,KAAK;AACL,IAAI,OAAO,EAAE;AACb,MAAM,MAAM,EAAE,CAAC,OAAO,EAAE,yBAAyB,CAAC;AAClD,KAAK;AACL,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,IAAI,CAAC,OAAO;AACd,EAAE;AACF,IAAI;AACJ,MAAM,MAAM,EAAE,OAAO;AACrB,MAAM,QAAQ,EAAE,MAAM;AACtB,MAAM,SAAS,EAAE,KAAK;AACtB,MAAM,SAAS,EAAE,GAAG;AACpB,MAAM,OAAO,EAAE,MAAM,CAAC,cAAc,CAAC;AACrC,MAAM,YAAY,EAAE,0BAA0B;AAC9C,MAAM,YAAY,EAAE,0BAA0B;AAC9C,MAAM,QAAQ,EAAE;AAChB,QAAQ,OAAO,EAAE;AACjB,UAAU,QAAQ,EAAE;AACpB,YAAY,MAAM,EAAE,CAAC,OAAO,EAAE,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC;AACnG,YAAY,UAAU,EAAE,CAAC,OAAO,EAAE,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,CAAC;AAC5G,YAAY,YAAY,EAAE,CAAC,OAAO,EAAE,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,sBAAsB,CAAC,CAAC;AAChH,WAAW;AACX,SAAS;AACT,QAAQ,QAAQ,EAAE;AAClB,UAAU,aAAa,EAAE,IAAI;AAC7B,UAAU,QAAQ,EAAE;AACpB,YAAY,MAAM,EAAE,CAAC,OAAO,EAAE,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC;AACnG,YAAY,UAAU,EAAE,CAAC,OAAO,EAAE,gBAAgB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,CAAC,CAAC;AAC7G,YAAY,MAAM,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;AACtC,WAAW;AACX,SAAS;AACT,OAAO;AACP,IAAG;AACH;AACA,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;AAC/C,EAAE,MAAM,IAAI,GAAG;AACf,IAAI,QAAQ,EAAE,KAAK;AACnB,GAAG,CAAC;AACJ,EAAE,MAAMA,KAAS,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;AAClC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}