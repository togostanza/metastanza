{"version":3,"file":"graph-2d-circle.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/graph-2d-circle/drawCircleLayout.js","../../../home/runner/work/metastanza/metastanza/stanzas/graph-2d-circle/index.js"],"sourcesContent":["import * as d3 from \"d3\";\n\nexport default function (\n  svg,\n  nodes,\n  edges,\n  {\n    width,\n    height,\n    MARGIN,\n    symbols,\n    labelsParams,\n    tooltipParams,\n    highlightAdjEdges,\n    edgeParams,\n  }\n) {\n  const HEIGHT = height - MARGIN.TOP - MARGIN.BOTTOM;\n  const WIDTH = width - MARGIN.LEFT - MARGIN.RIGHT;\n\n  const R = Math.min(WIDTH, HEIGHT) / 2;\n\n  // Laying out nodes ===\n  const angleScale = d3\n    .scalePoint()\n    .domain(nodes.map((node) => node.id))\n    .range([0, 360 - 360 / nodes.length]);\n\n  nodes.forEach((node) => {\n    node.x = Math.cos((angleScale(node.id) / 180) * Math.PI) * R + WIDTH / 2;\n    node.y = Math.sin((angleScale(node.id) / 180) * Math.PI) * R + HEIGHT / 2;\n  });\n\n  // =========\n\n  const circleG = svg\n    .append(\"g\")\n    .attr(\"id\", \"circleG\")\n    .attr(\"transform\", `translate(${MARGIN.LEFT},${MARGIN.TOP})`);\n\n  let links;\n  let draw;\n\n  if (edgeParams.type === \"line\") {\n    links = circleG\n      .selectAll(\"path\")\n      .data(edges)\n      .enter()\n      .append(\"line\")\n      .attr(\"class\", \"link\")\n      .style(\"stroke-width\", (d) => d[symbols.edgeWidthSym])\n      .style(\"stroke\", (d) => d[symbols.edgeColorSym])\n      .attr(\"x1\", (d) => d[symbols.sourceNodeSym].x)\n      .attr(\"y1\", (d) => d[symbols.sourceNodeSym].y)\n      .attr(\"x2\", (d) => d[symbols.targetNodeSym].x)\n      .attr(\"y2\", (d) => d[symbols.targetNodeSym].y);\n  } else if (edgeParams.type === \"curve\") {\n    draw = d3.line().curve(d3.curveBasis);\n\n    links = circleG\n      .selectAll(\"path\")\n      .data(edges)\n      .enter()\n      .append(\"path\")\n      .attr(\"class\", \"link\")\n      .style(\"stroke-width\", (d) => d[symbols.edgeWidthSym])\n      .style(\"stroke\", (d) => d[symbols.edgeColorSym])\n      .attr(\"d\", arc);\n  }\n\n  function movePoint(pointA, pointB, distance) {\n    // Move point a towards point b by distance\n    const vector = [pointB[0] - pointA[0], pointB[1] - pointA[1]];\n    const length = Math.sqrt(vector[0] * vector[0] + vector[1] * vector[1]);\n    const unitVector = [vector[0] / length, vector[1] / length];\n    return [\n      pointA[0] + unitVector[0] * distance,\n      pointA[1] + unitVector[1] * distance,\n    ];\n  }\n\n  function distance(a, b) {\n    return Math.sqrt(Math.pow(a[0] - b[0], 2) + Math.pow(a[1] - b[1], 2));\n  }\n\n  function arc(d) {\n    const sourceX = d[symbols.sourceNodeSym].x;\n    const targetX = d[symbols.targetNodeSym].x;\n    const sourceY = d[symbols.sourceNodeSym].y;\n    const targetY = d[symbols.targetNodeSym].y;\n    const midX = (sourceX + targetX) / 2;\n    const midY = (sourceY + targetY) / 2;\n\n    const factor =\n      ((distance([sourceX, sourceY], [targetX, targetY]) / angleScale.step()) *\n        Math.PI) /\n      180;\n    const movedPoint = movePoint(\n      [midX, midY],\n      [WIDTH / 2, HEIGHT / 2],\n      (distance([midX, midY], [WIDTH / 2, HEIGHT / 2]) *\n        edgeParams.curveStrength *\n        1.5 *\n        factor) /\n        100\n    );\n\n    return draw([[sourceX, sourceY], [...movedPoint], [targetX, targetY]]);\n  }\n\n  const nodeGroups = circleG\n    .selectAll(\"g\")\n    .data(nodes)\n    .enter()\n    .append(\"g\")\n    .attr(\"class\", \"node-group\")\n    .attr(\n      \"transform\",\n      (d) =>\n        `translate(${WIDTH / 2 + R},${HEIGHT / 2}) rotate(${angleScale(d.id)} ${\n          -WIDTH / 2\n        } 0)`\n    );\n\n  const nodeCircles = nodeGroups\n    .append(\"circle\")\n    .attr(\"class\", \"node\")\n    .style(\"fill\", (d) => d[symbols.nodeColorSym])\n    .attr(\"r\", (d) => d[symbols.nodeSizeSym]);\n\n  if (tooltipParams.show) {\n    nodeCircles.attr(\"data-tooltip\", (d) => d[tooltipParams.dataKey]);\n  }\n\n  if (labelsParams.dataKey !== \"\" && nodes[0][labelsParams.dataKey]) {\n    nodeGroups\n      .append(\"text\")\n      .text((d) => d[labelsParams.dataKey])\n      .attr(\"alignment-baseline\", \"middle\")\n      .attr(\"text-anchor\", (d) => {\n        if (angleScale(d.id) > 90 && angleScale(d.id) < 270) {\n          return \"end\";\n        }\n        return \"start\";\n      })\n      .attr(\"x\", (d) => {\n        if (angleScale(d.id) > 90 && angleScale(d.id) < 270) {\n          return -labelsParams.margin - d[symbols.nodeSizeSym];\n        }\n        return labelsParams.margin + d[symbols.nodeSizeSym];\n      })\n      .attr(\"transform\", (d) => {\n        if (angleScale(d.id) > 90 && angleScale(d.id) < 270) {\n          return \"rotate(180)\";\n        }\n        return null;\n      })\n      .attr(\"class\", \"label\");\n  }\n\n  if (highlightAdjEdges) {\n    nodeGroups.on(\"mouseover\", function (e, d) {\n      // highlight current node\n      d3.select(this).classed(\"active\", true);\n      // fade out all other nodes, highlight a little connected ones\n      nodeGroups\n        .classed(\"fadeout\", (p) => d !== p)\n        .classed(\"half-active\", (p) => {\n          return (\n            p !== d &&\n            d[symbols.edgeSym].some(\n              (edge) =>\n                edge[symbols.sourceNodeSym] === p ||\n                edge[symbols.targetNodeSym] === p\n            )\n          );\n        });\n\n      // fadeout not connected edges, highlight connected ones\n      links\n        .classed(\"fadeout\", (p) => !d[symbols.edgeSym].includes(p))\n        .classed(\"active\", (p) => d[symbols.edgeSym].includes(p));\n    });\n\n    nodeGroups.on(\"mouseleave\", function () {\n      links\n        .classed(\"active\", false)\n        .classed(\"fadeout\", false)\n        .classed(\"half-active\", false);\n      nodeGroups\n        .classed(\"active\", false)\n        .classed(\"fadeout\", false)\n        .classed(\"half-active\", false);\n    });\n  }\n}\n","import Stanza from \"togostanza/stanza\";\nimport * as d3 from \"d3\";\nimport loadData from \"togostanza-utils/load-data\";\nimport ToolTip from \"@/lib/ToolTip\";\nimport prepareGraphData from \"@/lib/prepareGraphData\";\nimport drawCircleLayout from \"./drawCircleLayout\";\n\nimport {\n  downloadSvgMenuItem,\n  downloadPngMenuItem,\n  downloadJSONMenuItem,\n  downloadCSVMenuItem,\n  downloadTSVMenuItem,\n  appendCustomCss,\n} from \"togostanza-utils\";\n\nexport default class ForceGraph extends Stanza {\n  menu() {\n    return [\n      downloadSvgMenuItem(this, \"graph-2d-force\"),\n      downloadPngMenuItem(this, \"graph-2d-force\"),\n      downloadJSONMenuItem(this, \"graph-2d-force\", this._data),\n      downloadCSVMenuItem(this, \"graph-2d-force\", this._data),\n      downloadTSVMenuItem(this, \"graph-2d-force\", this._data),\n    ];\n  }\n\n  async render() {\n    appendCustomCss(this, this.params[\"custom-css-url\"]);\n\n    const css = (key) => getComputedStyle(this.element).getPropertyValue(key);\n\n    //data\n\n    const width = parseInt(this.params[\"width\"]);\n    const height = parseInt(this.params[\"height\"]);\n\n    this.renderTemplate({\n      template: \"stanza.html.hbs\",\n    });\n\n    const values = await loadData(\n      this.params[\"data-url\"],\n      this.params[\"data-type\"],\n      this.root.querySelector(\"main\")\n    );\n\n    this._data = values;\n\n    const nodes = values.nodes;\n    const edges = values.links;\n\n    const MARGIN = {\n      TOP: this.params[\"padding\"],\n      BOTTOM: this.params[\"padding\"],\n      LEFT: this.params[\"padding\"],\n      RIGHT: this.params[\"padding\"],\n    };\n\n    // Setting color scale\n    const togostanzaColors = [];\n    for (let i = 0; i < 6; i++) {\n      togostanzaColors.push(css(`--togostanza-series-${i}-color`));\n    }\n\n    const color = function () {\n      return d3.scaleOrdinal().range(togostanzaColors);\n    };\n\n    const root = this.root.querySelector(\"main\");\n    const el = this.root.getElementById(\"graph-2d-circle\");\n\n    const existingSvg = root.getElementsByTagName(\"svg\")[0];\n    if (existingSvg) {\n      existingSvg.remove();\n    }\n    const svg = d3\n      .select(el)\n      .append(\"svg\")\n      .attr(\"width\", width)\n      .attr(\"height\", height);\n\n    this.tooltip = new ToolTip();\n    root.append(this.tooltip);\n\n    const nodesSortParams = {\n      sortBy: this.params[\"nodes-sort-by\"],\n      sortOrder: this.params[\"nodes-sort-order\"] || \"ascending\",\n    };\n\n    const nodeSizeParams = {\n      basedOn: this.params[\"node-size-based-on\"] || \"fixed\",\n      dataKey: this.params[\"node-size-data-key\"] || \"\",\n      fixedSize: this.params[\"node-fixed-size\"] || 3,\n      minSize: this.params[\"node-min-size\"],\n      maxSize: this.params[\"node-max-size\"],\n    };\n    const nodeColorParams = {\n      basedOn: this.params[\"node-color-based-on\"] || \"fixed\",\n      dataKey: this.params[\"node-color-data-key\"] || \"\",\n    };\n\n    const edgeWidthParams = {\n      basedOn: this.params[\"edge-width-based-on\"] || \"fixed\",\n      dataKey: this.params[\"edge-width-data-key\"] || \"\",\n      fixedWidth: this.params[\"edge-fixed-width\"] || 1,\n      minWidth: this.params[\"edge-min-width\"],\n      maxWidth: this.params[\"edge-max-width\"],\n    };\n\n    const edgeColorParams = {\n      basedOn: this.params[\"edge-color-based-on\"] || \"fixed\",\n      dataKey: this.params[\"edge-color-data-key\"] || \"\",\n    };\n\n    const labelsParams = {\n      margin: this.params[\"labels-margin\"],\n      dataKey: this.params[\"labels-data-key\"],\n    };\n\n    const tooltipParams = {\n      dataKey: this.params[\"nodes-tooltip-data-key\"],\n      show: nodes.some((d) => d[this.params[\"nodes-tooltip-data-key\"]]),\n    };\n\n    const edgeParams = {\n      type: this.params[\"edge-type\"] || \"curved\",\n      curveStrength: this.params[\"edge-curve-strength\"] || 0,\n    };\n\n    const highlightAdjEdges = this.params[\"highlight-adjacent-edges\"] || false;\n\n    const params = {\n      MARGIN,\n      width,\n      height,\n      svg,\n      color,\n      highlightAdjEdges,\n      nodesSortParams,\n      nodeSizeParams,\n      nodeColorParams,\n      edgeWidthParams,\n      edgeColorParams,\n      edgeParams,\n      labelsParams,\n      tooltipParams,\n    };\n\n    const { prepNodes, prepEdges, symbols } = prepareGraphData(\n      nodes,\n      edges,\n      params\n    );\n\n    drawCircleLayout(svg, prepNodes, prepEdges, { ...params, symbols });\n\n    this.tooltip.setup(el.querySelectorAll(\"[data-tooltip]\"));\n  }\n}\n"],"names":["d3\n    .scalePoint","d3.line","d3.curveBasis","d3.select","d3.scaleOrdinal","d3\n      .select"],"mappings":"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"}