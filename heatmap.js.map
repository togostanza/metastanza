{"version":3,"file":"heatmap.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/heatmap/index.js"],"sourcesContent":["import Stanza from \"togostanza/stanza\";\nimport loadData from \"togostanza-utils/load-data\";\nimport ToolTip from \"@/lib/ToolTip\";\nimport Legend from \"@/lib/Legend\";\nimport { getGradationColor } from \"@/lib/ColorGenerator\";\nimport * as d3 from \"d3\";\nconst tooltipHTML = ({ group, variable, value }) =>\n  `<span><strong>${group},${variable}: </strong>${value}</span>`;\n\nexport default class Heatmap extends Stanza {\n  css(key) {\n    return getComputedStyle(this.element).getPropertyValue(key);\n  }\n  async render() {\n    const root = this.root.querySelector(\"main\");\n    if (!this.tooltip) {\n      this.tooltip = new ToolTip();\n      root.append(this.tooltip);\n      this.legend = new Legend();\n      root.append(this.legend);\n    }\n\n    const data = await loadData(\n      this.params[\"data-url\"],\n      this.params[\"data-type\"],\n      this.root.querySelector(\"main\")\n    );\n\n    this.draw(root, data);\n  }\n  async draw(el, dataset) {\n    // make colors\n    const cellColorMin = this.params[\"cell-color-range_min\"];\n    const cellColorMid = this.params[\"cell-color-range_mid\"];\n    const cellColorMax = this.params[\"cell-color-range_max\"];\n    let cellDomainMin = parseFloat(this.params[\"cell-color-domain_min\"]);\n    let cellDomainMid = parseFloat(this.params[\"cell-color-domain_mid\"]);\n    let cellDomainMax = parseFloat(this.params[\"cell-color-domain_max\"]);\n    const cellColorDataKey = this.params[\"cell-color-data_key\"];\n    const values = [...new Set(dataset.map((d) => d[cellColorDataKey]))];\n\n    if (isNaN(parseFloat(cellDomainMin))) {\n      cellDomainMin = Math.min(...values);\n    }\n    if (isNaN(parseFloat(cellDomainMax))) {\n      cellDomainMax = Math.max(...values);\n    }\n    if (isNaN(parseFloat(cellDomainMid))) {\n      cellDomainMid = (cellDomainMax + cellDomainMin) / 2;\n    }\n\n    const setColor = getGradationColor(\n      this,\n      [cellColorMin, cellColorMid, cellColorMax],\n      [cellDomainMin, cellDomainMid, cellDomainMax]\n    );\n\n    const tickSize = +this.css(\"--togostanza-tick-size\") || 0;\n    const xLabelAngle = this.params[\"x-ticks_labels_angle\"] || 0;\n    const yLabelAngle = this.params[\"y-ticks_labels_angle\"] || 0;\n    const borderWidth = +this.css(\"--togostanza-border-width\") || 0;\n\n    // set the dimensions and margins of the graph\n    const margin = {\n      bottom: +this.css(\"--togostanza-fonts-font_size_primary\") + tickSize + 10,\n      left: +this.css(\"--togostanza-fonts-font_size_primary\") + tickSize + 10,\n    };\n    const width = +this.css(\"--togostanza-outline-width\"),\n      height = +this.css(\"--togostanza-outline-height\");\n\n    // remove svg element whenthis.params updated\n    d3.select(el).select(\"svg\").remove();\n    const titleSpace = 20;\n    const axisXTitlePadding = this.params[\"axis-x-title_padding\"];\n    const axisYTitlePadding = this.params[\"axis-y-title_padding\"];\n\n    const xDataKey = this.params[\"axis-x-data_key\"];\n    const yDataKey = this.params[\"axis-y-data_key\"];\n\n    const svg = d3\n      .select(el)\n      .append(\"svg\")\n      .attr(\"width\", width + margin.left + titleSpace + axisYTitlePadding)\n      .attr(\"height\", height + margin.bottom + titleSpace + axisXTitlePadding);\n\n    const graphArea = svg\n      .append(\"g\")\n      .attr(\"class\", \"chart\")\n      .attr(\n        \"transform\",\n        `translate(${margin.left + titleSpace + axisYTitlePadding}, 0)`\n      );\n\n    const rows = [...new Set(dataset.map((d) => d[xDataKey]))];\n    const columns = [...new Set(dataset.map((d) => d[yDataKey]))];\n\n    const x = d3\n      .scaleBand()\n      .domain(\n        rows.slice(\n          this.params[\"axis-x-range_min\"],\n          this.params[\"axis-x-range_max\"]\n        )\n      )\n      .range([0, width - 10]);\n    const xAxisGenerator = d3\n      .axisBottom(x)\n      .tickSizeOuter(0)\n      .tickSizeInner(tickSize);\n\n    const y = d3\n      .scaleBand()\n      .range([height, 0])\n      .domain(\n        columns.slice(\n          this.params[\"axis-y-range_min\"],\n          this.params[\"axis-y-range_max\"]\n        )\n      );\n    const yAxisGridGenerator = d3\n      .axisLeft(y)\n      .tickSizeOuter(0)\n      .tickSizeInner(tickSize);\n\n    // normalize\n\n    // console.log(values);\n    // const normalize = (num) => {\n    //   return (\n    //     (num - Math.min(...values)) /\n    //     (Math.max(...values) - Math.min(...values))\n    //   );\n    // };\n\n    graphArea\n      .selectAll()\n      .data(dataset, function (d) {\n        return d[xDataKey] + \":\" + d[yDataKey];\n      })\n      .enter()\n      .append(\"rect\")\n      .attr(\"x\", (d) => x(d[xDataKey]))\n      .attr(\"y\", (d) => y(d[yDataKey]))\n      .attr(\"data-tooltip-html\", true)\n      .attr(\"data-tooltip\", (d) => tooltipHTML(d))\n      .attr(\"width\", x.bandwidth())\n      .attr(\"height\", y.bandwidth())\n      .attr(\"rx\", this.css(\"--togostanza-border-radius\"))\n      .attr(\"ry\", this.css(\"--togostanza-border-radius\"))\n      .style(\"fill\", (d) => setColor(d[cellColorDataKey]))\n      .on(\"mouseover\", mouseover)\n      .on(\"mouseleave\", mouseleave);\n\n    graphArea\n      .append(\"g\")\n      .attr(\"class\", \"x-axis\")\n      .attr(\"transform\", `translate(0, ${height})`)\n      .transition()\n      .duration(200)\n      .call(xAxisGenerator)\n      .selectAll(\"text\")\n      .attr(\"transform\", `rotate(${xLabelAngle})`);\n\n    graphArea\n      .append(\"g\")\n      .attr(\"class\", \"y-axis\")\n      .transition()\n      .duration(200)\n      .call(yAxisGridGenerator)\n      .selectAll(\"text\")\n      .attr(\"transform\", `rotate(${yLabelAngle})`);\n\n    if (!this.params[\"axis-x-hide\"]) {\n      svg.select(\".x-axis path\").remove();\n    }\n    if (!this.params[\"axis-y-hide\"]) {\n      svg.select(\".y-axis path\").remove();\n    }\n    if (!this.params[\"axis-x-ticks_hide\"]) {\n      svg.selectAll(\".x-axis .tick line\").remove();\n    }\n    if (!this.params[\"axis-y-ticks_hide\"]) {\n      svg.selectAll(\".y-axis .tick line\").remove();\n    }\n\n    const axisXTitle = this.params[\"axis-x-title\"]\n      ? this.params[\"axis-x-title\"]\n      : xDataKey;\n    const axisYTitle = this.params[\"axis-y-title\"]\n      ? this.params[\"axis-y-title\"]\n      : yDataKey;\n\n    graphArea\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\n        \"transform\",\n        `translate(${width / 2}, ${height + margin.bottom + axisXTitlePadding})`\n      )\n      .text(axisXTitle);\n\n    graphArea\n      .append(\"text\")\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\n        \"transform\",\n        `translate(-${margin.left + axisYTitlePadding}, ${\n          height / 2\n        })rotate(-90)`\n      )\n      .text(axisYTitle);\n\n    graphArea.selectAll(\"text\").attr(\"class\", \"text\");\n\n    this.tooltip.setup(el.querySelectorAll(\"[data-tooltip]\"));\n    this.legend.setup(\n      this.intervals(values, setColor),\n      {},\n      this.root.querySelector(\"main\")\n    );\n\n    function mouseover() {\n      d3.select(this).classed(\"highlighted\", true).raise();\n      if (!borderWidth) {\n        d3.select(this)\n          .classed(\"highlighted\", true)\n          .style(\"stroke-width\", \"1px\")\n          .raise();\n      }\n    }\n    function mouseleave() {\n      d3.select(this).classed(\"highlighted\", false);\n      if (!borderWidth) {\n        d3.select(this)\n          .classed(\"highlighted\", false)\n          .style(\"stroke-width\", \"0px\");\n        graphArea.selectAll(\".x-axis\").raise();\n        graphArea.selectAll(\".y-axis\").raise();\n      }\n    }\n  }\n  // create legend objects based on min and max data values with number of steps as set by user in this.params\n  intervals(\n    values,\n    color,\n    steps = this.params[\"legend-groups\"] >= 2 ? this.params[\"legend-groups\"] : 2\n  ) {\n    const [min, max] = [Math.min(...values), Math.max(...values)];\n    return [...Array(steps).keys()].map((i) => {\n      const n = Math.round(min + i * (Math.abs(max - min) / (steps - 1)));\n      return {\n        label: n,\n        color: color(n),\n      };\n    });\n  }\n}\n"],"names":["d3.select","d3\n      .select","d3\n      .scaleBand","d3\n      .axisBottom","d3\n      .axisLeft"],"mappings":"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"}