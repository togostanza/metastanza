{"version":3,"file":"test-color-generator.js","sources":["../../../home/runner/work/metastanza/metastanza/stanzas/test-color-generator/index.js"],"sourcesContent":["import Stanza from \"togostanza/stanza\";\nimport {\n  InterpolateColorGenerator,\n  CirculateColorGenerator,\n  getColorSeries,\n  getColorsWithD3PresetColor,\n} from \"@/lib/ColorGenerator\";\nimport {\n  downloadSvgMenuItem,\n  downloadPngMenuItem,\n  downloadJSONMenuItem,\n  downloadCSVMenuItem,\n  downloadTSVMenuItem,\n  appendCustomCss,\n} from \"togostanza-utils\";\n\nexport default class TestColorGenerator extends Stanza {\n  menu() {\n    return [\n      downloadSvgMenuItem(this, \"TestColorGenerator\"),\n      downloadPngMenuItem(this, \"TestColorGenerator\"),\n      downloadJSONMenuItem(this, \"TestColorGenerator\", this.data),\n      downloadCSVMenuItem(this, \"TestColorGenerator\", this.data),\n      downloadTSVMenuItem(this, \"TestColorGenerator\", this.data),\n    ];\n  }\n\n  async render() {\n    appendCustomCss(this, this.params[\"custom-css-url\"]);\n\n    this.renderTemplate({ template: \"stanza.html.hbs\" });\n\n    const colorChips = this.root.querySelector(\"#color-chips\");\n\n    // get parameters\n    const numOfGradation = this.params[\"number-of-gradation\"];\n    const colorCirculation = this.params[\"type-of-color-circulation\"];\n    const colorDomain = this.params[\"color-domain\"]\n      ? this.params[\"color-domain\"].split(\",\").map((pos) => +pos)\n      : \"\";\n    const colorRange = this.params[\"color-range\"].split(\",\");\n    const NumOfMakeColor = this.params[\"number-of-make-color\"];\n    let d3ColorScheme = this.params[\"color-scheme\"];\n    let colors = [],\n      colorGenerator;\n\n    if (d3ColorScheme.indexOf(\"(\") !== -1) {\n      d3ColorScheme = d3ColorScheme.substr(0, d3ColorScheme.indexOf(\" (\"));\n    }\n\n    if (colorCirculation === \"interpolate\") {\n      if (\n        colorDomain.length !== 1 &&\n        colorRange.length !== 1 &&\n        colorDomain.length === colorRange.length\n      ) {\n        colorGenerator = new InterpolateColorGenerator(colorRange, colorDomain);\n      } else if (d3ColorScheme.indexOf(\"Categorical-\") !== -1) {\n        // categorical\n        d3ColorScheme = d3ColorScheme.replace(\"Categorical-\", \"\");\n        if (d3ColorScheme === \"Custom\") {\n          colors = getColorSeries(this);\n          colorGenerator = new InterpolateColorGenerator(colors, undefined);\n        } else {\n          const colors = getColorsWithD3PresetColor(\n            `scheme${d3ColorScheme}`,\n            numOfGradation\n          );\n          colorGenerator = new InterpolateColorGenerator(colors, undefined);\n        }\n      } else {\n        // continuous\n        d3ColorScheme = d3ColorScheme.replace(\"Continuous-\", \"\");\n        const colors = getColorsWithD3PresetColor(\n          `interpolate${d3ColorScheme}`,\n          numOfGradation\n        );\n        colorGenerator = new InterpolateColorGenerator(colors, undefined);\n      }\n    } else {\n      if (\n        colorDomain.length !== 1 &&\n        colorRange.length !== 1 &&\n        colorDomain.length === colorRange.length\n      ) {\n        colorGenerator = new CirculateColorGenerator(\n          colorRange,\n          colorDomain,\n          NumOfMakeColor\n        );\n      } else if (colorRange[0].length) {\n        colorGenerator = new CirculateColorGenerator(colorRange, undefined);\n      } else if (d3ColorScheme.indexOf(\"Categorical-\") !== -1) {\n        // categorical\n        d3ColorScheme = d3ColorScheme.replace(\"Categorical-\", \"\");\n        if (d3ColorScheme === \"Custom\") {\n          colors = getColorSeries(this);\n          colorGenerator = new CirculateColorGenerator(colors, undefined);\n        } else {\n          const colors = getColorsWithD3PresetColor(\n            `scheme${d3ColorScheme}`,\n            numOfGradation\n          );\n          colorGenerator = new CirculateColorGenerator(colors, undefined);\n        }\n      } else {\n        // continuous\n        d3ColorScheme = d3ColorScheme.replace(\"Continuous-\", \"\");\n        const colors = getColorsWithD3PresetColor(\n          `interpolate${d3ColorScheme}`,\n          numOfGradation\n        );\n        colorGenerator = new CirculateColorGenerator(colors, undefined);\n      }\n    }\n\n    switch (colorCirculation) {\n      case \"circulate\":\n        colorChips.innerHTML = [...Array(numOfGradation)]\n          .map((_, index) => {\n            return `<li data-pos=\"${index}\" style=\"background: ${colorGenerator.get(\n              index\n            )}\"></li>`;\n          })\n          .join(\"\");\n        break;\n\n      case \"interpolate\":\n        {\n          const unit = 1 / (numOfGradation - 1);\n          colorChips.innerHTML = [...Array(numOfGradation)]\n            .map((_, index) => {\n              return `<li data-pos=\"${\n                index * unit\n              }\" style=\"background: ${colorGenerator.get(index * unit)}\"></li>`;\n            })\n            .join(\"\");\n        }\n        break;\n    }\n  }\n\n  getColorSeries() {\n    const getPropertyValue = (key) =>\n      window.getComputedStyle(this.element).getPropertyValue(key);\n    const series = Array(6);\n    for (let i = 0; i < series.length; i++) {\n      series[i] = `--togostanza-series-${i}-color`;\n    }\n    return series.map((variable) => getPropertyValue(variable).trim());\n  }\n}\n"],"names":[],"mappings":"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"}